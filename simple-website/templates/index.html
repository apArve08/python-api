<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini AI Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        /* Dark mode variables */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --bg-tertiary: #f3f4f6;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --card-bg: #ffffff;
            --gradient-start: #667eea;
            --gradient-end: #764ba2;
        }

        .dark-mode {
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --bg-tertiary: #374151;
            --text-primary: #f9fafb;
            --text-secondary: #d1d5db;
            --border-color: #4b5563;
            --card-bg: #1f2937;
        }

        body {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .card-bg {
            background-color: var(--card-bg);
            transition: background-color 0.3s ease;
        }

        .text-secondary {
            color: var(--text-secondary);
        }

        .border-custom {
            border-color: var(--border-color);
        }

        .chat-scroll {
            scrollbar-width: thin;
            scrollbar-color: rgba(155, 155, 155, 0.5) transparent;
        }
        .chat-scroll::-webkit-scrollbar {
            width: 6px;
        }
        .chat-scroll::-webkit-scrollbar-track {
            background: transparent;
        }
        .chat-scroll::-webkit-scrollbar-thumb {
            background-color: rgba(155, 155, 155, 0.5);
            border-radius: 20px;
        }
        .message-enter {
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .typing-indicator {
            display: inline-flex;
            gap: 4px;
        }
        .typing-indicator span {
            width: 8px;
            height: 8px;
            background: #6366f1;
            border-radius: 50%;
            animation: bounce 1.4s infinite ease-in-out;
        }
        .typing-indicator span:nth-child(1) { animation-delay: -0.32s; }
        .typing-indicator span:nth-child(2) { animation-delay: -0.16s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
        .gradient-bg {
            background: linear-gradient(135deg, var(--gradient-start) 0%, var(--gradient-end) 100%);
        }
        pre code {
            border-radius: 8px;
            display: block;
            padding: 1rem;
        }
        .quick-action-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .quick-action-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        }
        .dark-mode .quick-action-card:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="gradient-bg shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <i class="fas fa-robot text-white text-2xl mr-3"></i>
                    <span class="text-white text-xl font-bold">Gemini AI Hub</span>
                </div>
                <div class="flex space-x-4">
                    <button onclick="showSection('chat')" class="nav-btn text-white hover:bg-white/20 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-comments mr-2"></i>Chat
                    </button>
                    <button onclick="showSection('quickactions')" class="nav-btn text-white hover:bg-white/20 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-bolt mr-2"></i>Quick Actions
                    </button>
                    <button onclick="showSection('quote')" class="nav-btn text-white hover:bg-white/20 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-quote-left mr-2"></i>Quote
                    </button>
                    <button onclick="showSection('summarize')" class="nav-btn text-white hover:bg-white/20 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-file-alt mr-2"></i>Summarize
                    </button>
                    <button onclick="showSection('code')" class="nav-btn text-white hover:bg-white/20 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-code mr-2"></i>Code
                    </button>
                    <button onclick="showSection('ideas')" class="nav-btn text-white hover:bg-white/20 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-lightbulb mr-2"></i>Ideas
                    </button>
                    <button onclick="toggleDarkMode()" class="text-white hover:bg-white/20 px-4 py-2 rounded-lg transition">
                        <i id="theme-icon" class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Chat Section -->
    <div id="chat-section" class="max-w-5xl mx-auto mt-8 px-4">
        <div class="card-bg rounded-2xl shadow-xl overflow-hidden">
            <!-- Chat Header -->
            <div class="bg-gradient-to-r from-indigo-500 to-purple-600 p-4 flex justify-between items-center">
                <div class="flex items-center">
                    <i class="fas fa-comments text-white text-xl mr-3"></i>
                    <h2 class="text-white text-xl font-semibold">AI Chat Assistant</h2>
                </div>
                <button onclick="clearChat()" class="bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition flex items-center">
                    <i class="fas fa-trash-alt mr-2"></i>Clear Chat
                </button>
            </div>

            <!-- Chat Box -->
            <div id="chat-box" class="h-[500px] overflow-y-auto p-6 space-y-4 chat-scroll" style="background-color: var(--bg-secondary);">
                <div class="text-center py-8" style="color: var(--text-secondary);">
                    <i class="fas fa-robot text-6xl mb-4 text-indigo-400"></i>
                    <p class="text-lg">Start a conversation with Gemini AI!</p>
                </div>
            </div>

            <!-- Input Area -->
            <div class="p-4 border-t border-custom">
                <div class="flex space-x-2">
                    <input 
                        type="text" 
                        id="user-input" 
                        placeholder="Type your message..." 
                        class="flex-1 px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 card-bg border-custom"
                        onkeypress="if(event.key === 'Enter') sendMessage()"
                    />
                    <button 
                        onclick="sendMessage()" 
                        class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg transition flex items-center font-semibold"
                    >
                        <i class="fas fa-paper-plane mr-2"></i>Send
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions Section -->
    <div id="quickactions-section" class="max-w-6xl mx-auto mt-8 px-4 hidden">
        <div class="card-bg rounded-2xl shadow-xl p-8">
            <div class="text-center mb-8">
                <i class="fas fa-bolt text-6xl text-yellow-400 mb-4"></i>
                <h2 class="text-3xl font-bold">Quick Actions</h2>
                <p class="text-secondary mt-2">Get instant AI-powered suggestions for your day</p>
            </div>
            
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                <button onclick="quickAction('sport')" class="quick-action-card p-6 bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 rounded-xl text-center">
                    <i class="fas fa-running text-4xl text-red-500 mb-3"></i>
                    <p class="font-semibold">Sport</p>
                    <p class="text-xs text-secondary mt-1">Workout ideas</p>
                </button>
                
                <button onclick="quickAction('food')" class="quick-action-card p-6 bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-xl text-center">
                    <i class="fas fa-utensils text-4xl text-green-500 mb-3"></i>
                    <p class="font-semibold">Food</p>
                    <p class="text-xs text-secondary mt-1">Meal suggestions</p>
                </button>
                
                <button onclick="quickAction('education')" class="quick-action-card p-6 bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 rounded-xl text-center">
                    <i class="fas fa-graduation-cap text-4xl text-blue-500 mb-3"></i>
                    <p class="font-semibold">Education</p>
                    <p class="text-xs text-secondary mt-1">Learn something new</p>
                </button>
                
                <button onclick="quickAction('entertainment')" class="quick-action-card p-6 bg-gradient-to-br from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 rounded-xl text-center">
                    <i class="fas fa-film text-4xl text-purple-500 mb-3"></i>
                    <p class="font-semibold">Entertainment</p>
                    <p class="text-xs text-secondary mt-1">Movies & shows</p>
                </button>
                
                <button onclick="quickAction('productivity')" class="quick-action-card p-6 bg-gradient-to-br from-indigo-50 to-blue-50 dark:from-indigo-900/20 dark:to-blue-900/20 rounded-xl text-center">
                    <i class="fas fa-tasks text-4xl text-indigo-500 mb-3"></i>
                    <p class="font-semibold">Productivity</p>
                    <p class="text-xs text-secondary mt-1">Efficiency tips</p>
                </button>
                
                <button onclick="quickAction('wellness')" class="quick-action-card p-6 bg-gradient-to-br from-pink-50 to-rose-50 dark:from-pink-900/20 dark:to-rose-900/20 rounded-xl text-center">
                    <i class="fas fa-spa text-4xl text-pink-500 mb-3"></i>
                    <p class="font-semibold">Wellness</p>
                    <p class="text-xs text-secondary mt-1">Self-care ideas</p>
                </button>
                
                <button onclick="quickAction('hobby')" class="quick-action-card p-6 bg-gradient-to-br from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 rounded-xl text-center">
                    <i class="fas fa-palette text-4xl text-yellow-500 mb-3"></i>
                    <p class="font-semibold">Hobby</p>
                    <p class="text-xs text-secondary mt-1">Creative activities</p>
                </button>
                
                <button onclick="quickAction('travel')" class="quick-action-card p-6 bg-gradient-to-br from-teal-50 to-cyan-50 dark:from-teal-900/20 dark:to-cyan-900/20 rounded-xl text-center">
                    <i class="fas fa-plane text-4xl text-teal-500 mb-3"></i>
                    <p class="font-semibold">Travel</p>
                    <p class="text-xs text-secondary mt-1">Destination ideas</p>
                </button>
            </div>
            
            <div id="quick-action-result" class="mt-6 hidden">
                <div class="card-bg border border-custom rounded-xl p-6" id="quick-action-content"></div>
            </div>
        </div>
    </div>

    <!-- Quote Section -->
    <div id="quote-section" class="max-w-3xl mx-auto mt-8 px-4 hidden">
        <div class="card-bg rounded-2xl shadow-xl p-8">
            <div class="text-center mb-6">
                <i class="fas fa-quote-left text-6xl text-indigo-400 mb-4"></i>
                <h2 class="text-3xl font-bold">Daily Inspiration</h2>
                <p class="text-secondary mt-2">Get motivated with AI-generated quotes</p>
            </div>
            
            <div id="quote-display" class="bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-indigo-900/20 dark:to-purple-900/20 rounded-xl p-8 min-h-[200px] flex items-center justify-center text-center">
                <p class="text-secondary text-lg">Click the button below for inspiration! âœ¨</p>
            </div>
            
            <button 
                onclick="fetchQuote()" 
                class="w-full mt-6 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-6 py-4 rounded-lg transition font-semibold text-lg"
            >
                <i class="fas fa-magic mr-2"></i>Generate New Quote
            </button>
        </div>
    </div>

    <!-- Summarize Section -->
    <div id="summarize-section" class="max-w-4xl mx-auto mt-8 px-4 hidden">
        <div class="card-bg rounded-2xl shadow-xl p-8">
            <div class="text-center mb-6">
                <i class="fas fa-file-alt text-6xl text-indigo-400 mb-4"></i>
                <h2 class="text-3xl font-bold">Text Summarizer</h2>
                <p class="text-secondary mt-2">Get concise summaries of long texts</p>
            </div>
            
            <textarea 
                id="summarize-input" 
                placeholder="Paste your text here to summarize..." 
                class="w-full h-64 p-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none card-bg border-custom"
            ></textarea>
            
            <button 
                onclick="summarizeText()" 
                class="w-full mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg transition font-semibold"
            >
                <i class="fas fa-compress-alt mr-2"></i>Summarize
            </button>
            
            <div id="summary-result" class="mt-6 hidden">
                <h3 class="text-xl font-semibold mb-3">Summary:</h3>
                <div class="bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-6" id="summary-content"></div>
            </div>
        </div>
    </div>

    <!-- Code Explainer Section -->
    <div id="code-section" class="max-w-4xl mx-auto mt-8 px-4 hidden">
        <div class="card-bg rounded-2xl shadow-xl p-8">
            <div class="text-center mb-6">
                <i class="fas fa-code text-6xl text-indigo-400 mb-4"></i>
                <h2 class="text-3xl font-bold">Code Explainer</h2>
                <p class="text-secondary mt-2">Understand code with AI explanations</p>
            </div>
            
            <select 
                id="code-language" 
                class="w-full mb-4 p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 card-bg border-custom"
            >
                <option value="python">Python</option>
                <option value="javascript">JavaScript</option>
                <option value="java">Java</option>
                <option value="cpp">C++</option>
                <option value="php">PHP</option>
                <option value="ruby">Ruby</option>
                <option value="go">Go</option>
            </select>
            
            <textarea 
                id="code-input" 
                placeholder="Paste your code here..." 
                class="w-full h-64 p-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono text-sm resize-none card-bg border-custom"
            ></textarea>
            
            <button 
                onclick="explainCode()" 
                class="w-full mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg transition font-semibold"
            >
                <i class="fas fa-search mr-2"></i>Explain Code
            </button>
            
            <div id="explanation-result" class="mt-6 hidden">
                <h3 class="text-xl font-semibold mb-3">Explanation:</h3>
                <div class="bg-indigo-50 dark:bg-indigo-900/20 rounded-lg p-6" id="explanation-content"></div>
            </div>
        </div>
    </div>

    <!-- Ideas Generator Section -->
    <div id="ideas-section" class="max-w-3xl mx-auto mt-8 px-4 hidden">
        <div class="card-bg rounded-2xl shadow-xl p-8">
            <div class="text-center mb-6">
                <i class="fas fa-lightbulb text-6xl text-yellow-400 mb-4"></i>
                <h2 class="text-3xl font-bold">Idea Generator</h2>
                <p class="text-secondary mt-2">Get creative project ideas instantly</p>
            </div>
            
            <div class="grid grid-cols-2 gap-4 mb-6">
                <button onclick="generateIdea('project')" class="p-6 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-xl transition text-center">
                    <i class="fas fa-project-diagram text-3xl text-blue-600 mb-2"></i>
                    <p class="font-semibold">Project Idea</p>
                </button>
                <button onclick="generateIdea('business')" class="p-6 bg-green-50 dark:bg-green-900/20 hover:bg-green-100 dark:hover:bg-green-900/30 rounded-xl transition text-center">
                    <i class="fas fa-briefcase text-3xl text-green-600 mb-2"></i>
                    <p class="font-semibold">Business Idea</p>
                </button>
                <button onclick="generateIdea('app')" class="p-6 bg-purple-50 dark:bg-purple-900/20 hover:bg-purple-100 dark:hover:bg-purple-900/30 rounded-xl transition text-center">
                    <i class="fas fa-mobile-alt text-3xl text-purple-600 mb-2"></i>
                    <p class="font-semibold">App Idea</p>
                </button>
                <button onclick="generateIdea('content')" class="p-6 bg-pink-50 dark:bg-pink-900/20 hover:bg-pink-100 dark:hover:bg-pink-900/30 rounded-xl transition text-center">
                    <i class="fas fa-pen text-3xl text-pink-600 mb-2"></i>
                    <p class="font-semibold">Content Idea</p>
                </button>
            </div>
            
            <div id="idea-result" class="mt-6 hidden">
                <div class="bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-xl p-6" id="idea-content"></div>
            </div>
        </div>
    </div>

    <script>
        const sessionId = Date.now().toString();

        // Dark Mode Toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const icon = document.getElementById('theme-icon');
            
            if (document.body.classList.contains('dark-mode')) {
                icon.className = 'fas fa-sun';
                localStorage.setItem('darkMode', 'enabled');
            } else {
                icon.className = 'fas fa-moon';
                localStorage.setItem('darkMode', 'disabled');
            }
        }

        // Load dark mode preference
        window.addEventListener('DOMContentLoaded', () => {
            const darkMode = localStorage.getItem('darkMode');
            if (darkMode === 'enabled') {
                document.body.classList.add('dark-mode');
                document.getElementById('theme-icon').className = 'fas fa-sun';
            }
        });

        function showSection(section) {
            ['chat-section', 'quickactions-section', 'quote-section', 'summarize-section', 'code-section', 'ideas-section'].forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
            document.getElementById(section + '-section').classList.remove('hidden');
        }

        // Quick Actions Function
        async function quickAction(type) {
            const resultDiv = document.getElementById("quick-action-result");
            const contentDiv = document.getElementById("quick-action-content");
            
            resultDiv.classList.remove("hidden");
            contentDiv.innerHTML = `
                <div class="flex items-center justify-center py-8">
                    <div class="typing-indicator">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            `;

            try {
                const response = await fetch("/quick_action", {
                    method: "POST",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify({type})
                });

                const data = await response.json();
                
                if (data.error) {
                    contentDiv.innerHTML = `<p class="text-red-500">Error: ${data.error}</p>`;
                } else {
                    contentDiv.innerHTML = marked.parse(data.suggestion);
                }
            } catch (error) {
                contentDiv.innerHTML = `<p class="text-red-500">Failed to fetch suggestion. Please try again.</p>`;
            }
        }

        async function sendMessage() {
            const input = document.getElementById("user-input");
            const message = input.value.trim();
            if (!message) return;

            addMessage("user", message);
            input.value = "";

            // Show typing indicator
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.className = 'flex justify-start message-enter';
            typingDiv.innerHTML = `
                <div class="bg-gray-200 dark:bg-gray-700 rounded-2xl px-4 py-3 max-w-[70%]">
                    <div class="typing-indicator">
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
            `;
            document.getElementById('chat-box').appendChild(typingDiv);
            document.getElementById('chat-box').scrollTop = document.getElementById('chat-box').scrollHeight;

            try {
                const response = await fetch("/chat", {
                    method: "POST",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify({message, session_id: sessionId})
                });

                const data = await response.json();
                document.getElementById('typing-indicator').remove();
                
                if (data.error) {
                    addMessage("bot", "Sorry, I encountered an error: " + data.error);
                } else {
                    addMessage("bot", data.reply);
                }
            } catch (error) {
                document.getElementById('typing-indicator')?.remove();
                addMessage("bot", "Sorry, something went wrong. Please try again.");
            }
        }

        function addMessage(sender, text) {
            const chatBox = document.getElementById("chat-box");
            const msg = document.createElement("div");
            msg.className = `flex ${sender === "user" ? "justify-end" : "justify-start"} message-enter`;
            
            const bgColor = sender === "user" ? "bg-indigo-600 text-white" : "card-bg border border-custom";
            const icon = sender === "user" ? '<i class="fas fa-user"></i>' : '<i class="fas fa-robot"></i>';
            
            // Convert markdown to HTML for bot messages
            let formattedText = text;
            if (sender === "bot") {
                formattedText = marked.parse(text);
            }
            
            msg.innerHTML = `
                <div class="${bgColor} rounded-2xl px-4 py-3 max-w-[70%] shadow-sm">
                    <div class="flex items-start gap-2">
                        <div class="mt-1">${icon}</div>
                        <div class="prose prose-sm max-w-none">${sender === "user" ? text : formattedText}</div>
                    </div>
                </div>
            `;
            
            chatBox.appendChild(msg);
            
            // Highlight code blocks
            if (sender === "bot") {
                msg.querySelectorAll('pre code').forEach((block) => {
                    hljs.highlightElement(block);
                });
            }
            
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        async function clearChat() {
            if (confirm("Are you sure you want to clear the chat?")) {
                await fetch("/clear_chat", {
                    method: "POST",
                    headers: {"Content-Type": "application/json"},
                    body: JSON.stringify({session_id: sessionId})
                });
                document.getElementById("chat-box").innerHTML = `
                    <div class="text-center py-8" style="color: var(--text-secondary);">
                        <i class="fas fa-robot text-6xl mb-4 text-indigo-400"></i>
                        <p class="text-lg">Start a conversation with Gemini AI!</p>
                    </div>
                `;
            }
        }

        async function fetchQuote() {
            const display = document.getElementById("quote-display");
            display.innerHTML = `
                <div class="typing-indicator mx-auto">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;
            
            const response = await fetch("/get_quote", { method: "POST" });
            const data = await response.json();
            
            display.innerHTML = `<p class="text-xl italic leading-relaxed">${data.quote}</p>`;
        }

        async function summarizeText() {
            const text = document.getElementById("summarize-input").value.trim();
            if (!text) {
                alert("Please enter some text to summarize!");
                return;
            }

            const resultDiv = document.getElementById("summary-result");
            const contentDiv = document.getElementById("summary-content");
            
            resultDiv.classList.remove("hidden");
            contentDiv.innerHTML = `
                <div class="typing-indicator">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;

            const response = await fetch("/summarize", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({text})
            });

            const data = await response.json();
            contentDiv.innerHTML = `<p class="leading-relaxed">${data.summary}</p>`;
        }

        async function explainCode() {
            const code = document.getElementById("code-input").value.trim();
            const language = document.getElementById("code-language").value;
            
            if (!code) {
                alert("Please enter some code to explain!");
                return;
            }

            const resultDiv = document.getElementById("explanation-result");
            const contentDiv = document.getElementById("explanation-content");
            
            resultDiv.classList.remove("hidden");
            contentDiv.innerHTML = `
                <div class="typing-indicator">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;

            const response = await fetch("/explain_code", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({code, language})
            });

            const data = await response.json();
            contentDiv.innerHTML = marked.parse(data.explanation);
        }

        async function generateIdea(category) {
            const resultDiv = document.getElementById("idea-result");
            const contentDiv = document.getElementById("idea-content");
            
            resultDiv.classList.remove("hidden");
            contentDiv.innerHTML = `
                <div class="typing-indicator">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;

            const response = await fetch("/generate_idea", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({category})
            });

            const data = await response.json();
            contentDiv.innerHTML = marked.parse(data.idea);
        }

        // Initialize marked options
        marked.setOptions({
            breaks: true,
            gfm: true
        });
    </script>
</body>
</html>